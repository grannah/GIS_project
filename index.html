<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>GIS_project</title>
    <script type='text/javascript' src='http://www.openlayers.org/api/OpenLayers.js'></script>
  </head>

  <body bgcolor="green">
    <section class="page-header">
      <h1 class="project-name"><font color="white">OpenLayers Map<font/></h1>
    </section>
    <button type="button" onclick="alert('Doesn't work yet')">Find route</button>
    <button type="button" onclick="alert('Doesn't work yet')">Analyze</button>
    
    <form name="input" action="javascript: submitform();" method="post">
    <label for="query">Search for address:</label> <input type="text" id="query" size=50 name="query"
                                                          value="Type an address"/>
    <input type="submit" value="Submit"/>
    </form>

    <section class="main-content">
      <div id="map" style="height:500px"></div>
      
      <script>
        map = new OpenLayers.Map("map", 
          {
	  units:'m',
	  controls: [new OpenLayers.Control.Navigation()]
        });
        OSMmap = new OpenLayers.Layer.OSM();
        //map.addLayer(OSMmap);

        var wms = new OpenLayers.Layer.WMS("Liikuntapaikat", "http://localhost:8080/geoserver/GIS_project/wms",
            	{layers: "GIS_project:lipas_kaikki_pisteet",
            	transparent: true,
            	format: 'image/png'},
            	{'opacity': 0.66, 'isBaseLayer': false, projection: 'EPSG:900913'});
        map.addLayers([OSMmap, wms]);
        
        var lat = 60.170833;
        var lon = 24.9375;
        var zoom = 14;
      
        var markers = new OpenLayers.Layer.Markers( "Markers" );
        map.addLayer(markers);
      
        // Recenter on user position
        navigator.geolocation.getCurrentPosition(function(position) {
      	  	document.getElementById('Location').innerHTML= 
      	  	" Latitude: " + 
      	  	position.coords.latitude + 
      	  	" Longitude: " +
      	  	position.coords.longitude;
      	
      	var lonLat = new OpenLayers.LonLat(position.coords.longitude, position.coords.latitude)
      		.transform(new OpenLayers.Projection("EPSG:4326"), //transform from WGS 1984
      		map.getProjectionObject()); //to Spherical Mercator Projection
      		markers.addMarker(new OpenLayers.Marker(lonLat));
        map.setCenter(lonLat, zoom);
        });
      
        map.addControl(new OpenLayers.Control.LayerSwitcher());
        map.addControl(new OpenLayers.Control.ScaleLine());
        map.addControl(new OpenLayers.Control.MousePosition());
        map.addControl(new OpenLayers.Control.PanZoomBar());
      </script>
      
      <p id="Location"></p>
      
      <footer class="site-footer">
        <h>GIS Software Development course</h>
      </footer>

    </section>
  </body>
</html>
